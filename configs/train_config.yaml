# Facial Expression Recognition Training Configuration

# Dataset
data:
  root_dir: "data/RAF-DB/DATASET"
  train_dir: "train"
  test_dir: "test"
  num_classes: 7
  class_names:
    - "Surprise"
    - "Fear"
    - "Disgust"
    - "Happiness"
    - "Sadness"
    - "Anger"
    - "Neutral"

# Model
model:
  name: "mobilenetv3_large_100.ra_in1k"
  pretrained: true
  num_classes: 7

# Image transforms
transform:
  img_size: 224
  mean: [0.485, 0.456, 0.406]
  std:  [0.229, 0.224, 0.225]
  # Augmentation (train only)
  random_horizontal_flip: 0.5
  random_rotation: 20
  random_affine:
    translate: [0.1, 0.1]
    scale: [0.9, 1.1]
  color_jitter:
    brightness: 0.3
    contrast: 0.3
    saturation: 0.3
    hue: 0.1
  gaussian_blur:
    kernel_size: 5
    probability: 0.2
  random_grayscale: 0.1
  random_erasing: 0.25

# Training
train:
  epochs: 30
  batch_size: 64
  lr: 1.0e-3
  weight_decay: 1.0e-4
  scheduler: "cosine"
  warmup_epochs: 3
  num_workers: 4
  pin_memory: true
  use_weighted_loss: true
  weight_mode: "sqrt"
  label_smoothing: 0.1
  mixup_alpha: 0.2
  cutmix_alpha: 1.0
  freeze_backbone_epochs: 2
  backbone_lr_scale: 0.5
  ema_decay: 0.998
  oversample: false # WeightedRandomSampler (conflicts with weighted loss)
  tta: false # Test-Time Augmentation (horizontal flip)

# Output
output:
  dir: "outputs"
  best_model_name: "best_model.pth"
